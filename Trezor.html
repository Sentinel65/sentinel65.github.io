<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hra Trezor</title>
  <style>
    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      font-family: Arial, sans-serif;
    }
    #gameContainer {
      display: grid;
      grid-template-areas: 
        "letters letters letters"
        "left board right"
        "bottom bottom bottom"
        "skimmers skimmers skimmers";
      gap: 10px;
    }
    #board {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      grid-gap: 5px;
      justify-content: center;
      margin: 10px;
      grid-area: board;
    }
    .cell {
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 1px solid #000;
      font-size: 14px;
      cursor: pointer;
      user-select: none;
    }
    .cell.clicked { background-color: #4B4C4B; color: #fff;cursor: not-allowed;pointer-events: none;} /* Styl oznaƒçen√Ωch pol√≠ƒçek */
    .disabled { background-color: #000; cursor: default; } /* Nehrateln√° pol√≠ƒçka */
    .used { background-color: #d3d3d3; cursor: default; color: #333; } /* Styl pou≈æit√Ωch kostek */
    .odd { background-color: #e0ffe0; } /* Lich√° ƒç√≠sla */
    .even { background-color: #e0e0ff; } /* Sud√° ƒç√≠sla */
    .double { background-color: #ffe0e0; } /* Double */
    #letters, #left, #right, #bottom {
      display: grid;
      font-weight: bold;
      font-size: 16px;
      text-align: center;
    }
    #letters {
      grid-template-columns: repeat(7, 1fr);
      grid-area: letters;
	  margin-right: 30px;
    }
    #left {
      grid-template-rows: repeat(6, 1fr);
      grid-area: left;
      justify-content: end;
      margin-top: 28px;
    }
    #right {
      grid-template-rows: repeat(6, 1fr);
      grid-area: right;
      margin-top: 28px;
    }
    #bottom {
      grid-template-columns: repeat(7, 1fr);
      grid-area: bottom;
	  margin-right: 18px;
    }
    #skimmers {
      grid-area: skimmers;
      display: flex;
      justify-content: center;
      gap: 20px;
      text-align: center;
      font-weight: bold;
      font-size: 16px;
    }
    .score {
    font-size: 14px;
    font-weight: bold;
    }
    .highscore {
    font-size: 14px;
    font-weight: bold;
    }
    .skimmer {
      padding: 5px 10px;
      border: 2px solid #333;
      border-radius: 5px;
      cursor: pointer;
      user-select: none;
    }
    .skimmer.clicked { background-color: #90cfff; } /* Styl oznaƒçen√Ωch skimmer≈Ø */
    #diceContainer {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }
    .skimmer.disabled {
	  background-color: #d3d3d3;
	  color: #888;
	  cursor: not-allowed;
	  border-color: #888;
	}
    
      /* Stylov√°n√≠ pro tlaƒç√≠tka n√°povƒõdy  */
	  .help-button {
		padding: 5px 10px;
		border: 2px solid #333;
		border-radius: 5px;
		cursor: pointer;
		color: white;
		background-color: #4B4C4B;
		font-size: 20px;
		font-weight: bold;
		user-select: none;
	 }
    
      /* Stylov√°n√≠ pro tlaƒç√≠tka ReRoll */
	  .reroll-button {
		padding: 5px 10px;
		border: 2px solid #333;
		border-radius: 5px;
		cursor: pointer;
		background-color: #90cfff;
		font-size: 14px;
		font-weight: bold;
		user-select: none;
	 }

	  /* Styl pro deaktivovan√° tlaƒç√≠tka */
	  .reroll-button.disabled {
		background-color: #d3d3d3;
		color: #888;
		cursor: not-allowed;
		border-color: #888;
	 }
	   .highlight {
	  background-color: lightgreen;
	  color: black;
	  font-weight: bold;
	} 
	  .highlight-empty {
	  background-color: yellow;
	  color: black;
	  font-weight: bold;
	}

	  .highlight-filled {
	  background-color: #4B4C4B;
	  color: yellow;
	  font-weight: bold;
	}
		.die {
		  width: 40px;
		  height: 40px;
		  display: flex;
		  align-items: center;
		  justify-content: center;
		  border: 2px solid #333;
		  border-radius: 5px;
		  font-size: 18px;
		  font-weight: bold;
		  cursor: pointer;
		  user-select: none;
		}
    .die.clicked { background-color: #90cfff; } /* Styl oznaƒçen√Ωch kostek */
    #rollButton {
      margin-top: 15px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
    }
    @media (max-width: 600px) {
      .cell, .die {
        width: 30px;
        height: 30px;
        font-size: 12px;
      }
      #letters, #left, #right, #bottom, #skimmers {
        font-size: 14px;
      }
      .skimmer { padding: 5px; }
    }
		/* Mod√°ln√≠ okno */
	.modal {
	  display: none;
	  position: fixed;
	  z-index: 1;
	  padding-top: 60px;
	  left: 0;
	  top: 0;
	  width: 100%;
	  height: 100%;
	  overflow: auto;
	  background-color: rgb(0,0,0);
	  background-color: rgba(0,0,0,0.4);
	}

	/* Obsah mod√°ln√≠ho okna */
	.modal-content {
	  background-color: #fefefe;
	  margin: 5% auto;
	  padding: 20px;
	  border: 1px solid #888;
	  width: 80%;
	}

	/* Tlaƒç√≠tko pro zav≈ôen√≠ mod√°ln√≠ho okna */
	.close {
	  color: #aaa;
	  float: right;
	  font-size: 28px;
	  font-weight: bold;
	}

	.close:hover,
	.close:focus {
	  color: black;
	  text-decoration: none;
	  cursor: pointer;
	}
  </style>
</head>
<body>




<p><button class="help-button" onclick="selectBoardMenu()">üè†</button>&nbsp;<button id="helpButton" class="help-button" onclick="showHelp()">üí°</button>&nbsp;<button class="help-button" >Trezor</button>&nbsp;<button class="help-button" onclick="displayGameStatsInModal()">üèÜ</button>&nbsp;<button id="helpButton" class="help-button" onclick="manualEndRound()">üö´</button></p>
<div id="helpModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeHelp()">&times;</span>
  <h2>TREZOR</h2>
    <p>Kostkov√° solitaire hra. Zdigitalizovan√° verze (JavaScript) PnP hry <b>"Vault: A Solitaire Dice Game (2021)"</b>, autorem je <b>Wayne Koenig</b></p>
    <p>Ve h≈ôe p≈ôedstavujete bankovn√≠ho lupiƒçe, kter√Ω se sna≈æ√≠ prolomit specializovan√Ω trezor. Pomoc√≠ hodu kostkami a peƒçliv√©ho pl√°nov√°n√≠ douf√°te, ≈æe se v√°m poda≈ô√≠ dostat ven s co nejvƒõt≈°√≠m poƒçtem diamant≈Ø d≈ô√≠ve, ne≈æ se v≈°echny z√°mky na trezoru zav≈ôou. Nƒõkter√© z√°mky obsahuj√≠ v√≠ce diamant≈Ø ne≈æ jin√©, tak≈æe je na v√°s, abyste se rozhodli, na kter√©m z√°mku str√°v√≠te sv≈Øj ƒças s ohledem na hozen√© hodnoty na kostk√°ch.</p>
  <h3>Pr≈Øbƒõh hry</h3>
    <p>Trezor, kter√Ω se sna≈æ√≠te rozlousknout, m√° 12 z√°mk≈Ø, na ka≈æd√©m z nich je p√≠smeno, kter√© p≈ôedstavuje jedno kolo (A ‚Äì L). Na konci ka≈æd√©ho kola (v abecedn√≠m po≈ôad√≠ p√≠smen) se zav≈ôe p≈ô√≠slu≈°n√Ω z√°mek, ƒç√≠m≈æ se odstran√≠ ≈°ance na z√≠sk√°n√≠ diamant≈Ø v jeho ≈ôadƒõ nebo sloupci.</p>
    <p>V ka≈æd√©m kole je t≈ôeba splnit 4 kroky:
       <ol>
         <li>Na zaƒç√°tku ka≈æd√©ho kola program automaticky vygeneruje hod 5 kostek</li>
         <li>Pot√© kliknut√≠m oznaƒçte pole (ƒçtvereƒçky), kter√° odpov√≠daj√≠ hodnot√°m (nebo jejich kombinaci) na hozen√Ωch kostk√°ch</li>
         <li>Jakmile pou≈æijete v≈°ech 5 kostek, dan√© kolo skonƒç√≠. Z√°mek z≈Østane otev≈ôen√Ω nebo se uzamkne v z√°vislosti na tom, zda v dan√©m kole budou u ≈ôe≈°en√©ho z√°mku (v ≈ô√°dku nebo sloupci) oznaƒçena v≈°echna pole (ƒçtvereƒçky). Pokud ano, hodnota pol√≠ dan√©ho z√°mku se zmƒõn√≠ na znak "o". Aktu√°lnƒõ ≈ôe≈°en√Ω z√°mek m√° podbarven√° pol√≠ƒçka ≈ælutou barvou, ji≈æ oznaƒçen√° maj√≠ hodnotu ve ≈ælut√© barvƒõ.</li>
         <li>Postup opakujeme a≈æ do kola se z√°mkem ‚ÄûL‚Äú, pot√© hra konƒç√≠.</li>
       </ol>

  <h3>Oznaƒçen√≠ pol√≠ƒçek</h3>
    <p>K oznaƒçen√≠ pol√≠ƒçek, kter√© se nach√°zej√≠ v Trezoru, nebo pol√≠ƒçek ve v≈°ech t≈ôech ‚Äû≈†perh√°c√≠ch‚Äú, m≈Ø≈æete v dan√©m kole pou≈æ√≠t libovoln√Ω poƒçet nepou≈æit√Ωch hozen√Ωch kostek (hodnoty m≈Ø≈æete sƒç√≠tat nebo odeƒç√≠tat), jejich≈æ celkov√° hodnota se shoduje s konkr√©tn√≠ ƒç√≠selnou hodnotou na pol√≠ƒçku v Trezoru. 
Na nƒõkter√° pol√≠ƒçka staƒç√≠ pouze jedna kostka. Na vƒõt≈°inƒõ pol√≠ƒçek v Trezoru je uvedeno ƒç√≠slo. U nƒõkter√Ωch je ale hodnota dan√° znakem ‚Äû<b>L</b>‚Äú (lich√°), ‚Äû<b>S</b>‚Äú (sud√°) nebo ‚Äû<b>D</b>‚Äú (double).
Na pol√≠ƒçko ‚ÄûLich√°‚Äú nebo ‚ÄûSud√°‚Äú je pot≈ôeba pouze ‚Äû<b>jedna</b>‚Äú kostka, jej√≠ hodnota pak mus√≠ b√Ωt buƒè lich√° nebo sud√°. Nesm√≠te kombinovat hodnoty dvou kostek tak, aby se rovnala hodnotƒõ t≈ôet√≠ kostky.
Na pol√≠ƒçko ‚Äû<b>D</b>‚Äú jsou ale t≈ôeba ‚Äû<b>dvƒõ</b>‚Äú kostky, na hodnotƒõ nez√°le≈æ√≠, ale hodnota mus√≠ b√Ωt na obou kostk√°ch ‚Äû<b>stejn√°</b>‚Äú. Nesm√≠te kombinovat hodnoty dvou kostek tak, aby se rovnala hodnotƒõ t≈ôet√≠ kostky.</p>

  <h3>≈†perh√°ky </h3>
    <p>≈†perh√°ky jsou za≈ô√≠zen√≠, kter√° jsou pou≈æ√≠van√° k prolamov√°n√≠ elektronick√Ωch trezor≈Ø. Nechceme-li nebo nem≈Ø≈æeme-li pou≈æ√≠t v≈°echny kostky k oznaƒçen√≠ pol√≠ƒçek v trezoru, m≈Ø≈æete kostky pou≈æ√≠t k nab√≠jen√≠ ≈†perh√°ku. Nab√≠jen√≠ ≈†perh√°ku umo≈æ≈àuje ukl√°dat nepou≈æit√© kostky v dan√©m kole tak, ≈æe se jejich hodnoty ‚Äû<b>seƒçtou</b>‚Äú a v√Ωsledn√° hodnota se zakresl√≠ do kter√©hokoli ze t≈ô√≠ ≈†perh√°k≈Ø. Ka≈ædou kostku lze pou≈æ√≠t pouze do jednoho ≈†perh√°ku. </p>
    <p>≈†perh√°k m≈Ø≈æeme kdykoli v dan√©m kole pou≈æ√≠t k oznaƒçen√≠ pol√≠ƒçka v Trezoru jako dal≈°√≠ "virtu√°ln√≠" kostku, kter√° m√° hodnotu, jakou m√° vybran√Ω ≈†perh√°k. M≈Ø≈æeme jej  pou≈æ√≠t samostatnƒõ nebo v kombinaci (souƒçet, odeƒçet) s jakoukoli jinou kostkou.<b>Jakmile je ≈†perh√°k ji≈æ jednou pou≈æit, nelze do nƒõj ji≈æ p≈ôid√°vat, ani jej znovu pou≈æ√≠t.</b></p> 

  <h3>Opakovan√© hody</h3>
    <p>V pr≈Øbƒõhu hry m≈Ø≈æete kdykoli 3x opakovat hod. P≈ôi opakovan√©m hodu m≈Ø≈æete pou≈æ√≠t libovoln√Ω poƒçet nepou≈æit√Ωch kostek (1 ‚Äì 5). <b>Pozn√°mka: Opakovan√Ω hod m≈Ø≈æete pou≈æ√≠t 3x i bƒõhem sv√©ho tahu v jednom kole.</b></p>
  
  <h3>Kr√°de≈æ diamant≈Ø</h3>
    <p>Poda≈ô√≠-li se v√°m v dan√©m kole oznaƒçit v≈°echna pol√≠ƒçka v p≈ô√≠slu≈°n√©m sloupci ƒçi ≈ô√°dku dan√©ho z√°mku, z√≠sk√°v√°te tento poƒçet diamant≈Ø:
     <ul>
       <li>1 u z√°mk≈Ø A, B, C, D, E, F</li>
       <li>2 u z√°mk≈Ø G, H, I</li>
       <li>3 u z√°mk≈Ø J, K, L</li>
     </ul>
     Pozn√°mka: nƒõkter√© z√°mky maj√≠ v√≠ce diamant≈Ø, z hlediska taktiky je tedy lep≈°√≠ oznaƒçit d≈ô√≠ve pol√≠ƒçka ve sloupci ƒçi ≈ô√°dku tƒõchto z√°mk≈Ø. 
    </p>
    
  <h3>Konec kola</h3>
    <p>Jakmile pou≈æijete v≈°echny kostky, kolo konƒç√≠. </p>
    
  <h3>Konec hry</h3>  
    <p>Hra konƒç√≠, jakmile dokonƒç√≠te kolo se z√°mkem ‚ÄûL‚Äú. Program spoƒç√≠t√° v≈°echny diamanty u otev≈ôen√Ωch z√°mk≈Ø (za ka≈æd√Ω 1 bod) a nepou≈æit√© ≈†perh√°ky (za ka≈æd√Ω 1 bod).</p>
      <ul>
          <li>Jde≈° do vƒõzen√≠: m√©nƒõ ne≈æ 10</li>		  
          <li>Lapka: 10 - 12 </li>
          <li>Kaps√°≈ô: 13 - 15</li>
          <li>Zlodƒõj: 16 - 18</li>
          <li>Bankovn√≠ lupiƒç: 19 - 21</li>
          <li>Ars√®ne Lupin: 22 a v√≠ce</li>
      </ul>
	<p><b>Pozn√°mka:</b> ikony v horn√≠m ≈ô√°dku obrazovky s n√°zvem hry</p> 
      <ul>
		  <li>üè† menu s v√Ωbƒõrem hrac√≠ desky</li> 
		  <li>üí° n√°povƒõda</li>
		  <li>üèÜ statistiky hry </li>
		  <li>üö´ manu√°ln√≠ ukonƒçen√≠ kola (v posledn√≠ch kolech se m≈Ø≈æe st√°t, ≈æe hr√°ƒç ji≈æ nebude m√≠t k dispozici ≈æ√°dn√Ω ≈†perh√°k, opakovan√Ω hod a hodnoty kostek neumo≈æn√≠ dokonƒçit standardn√≠ cestou kolo).</li>
	  </ul>
      <p>&nbsp;</p>
      <p>&nbsp;</p>
  </div>
</div>

<div id="statsModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeStatsModal()">&times;</span>
    <h2>Statistiky hry</h2>
    <div id="totalStats"></div>
    <div id="boardStats"></div>
  </div>
</div>

<div id="gameContainer">
  <!-- Oznaƒçen√≠ sloupc≈Ø naho≈ôe -->
  <div id="letters">
    <div></div><div></div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A</div><div></div><div>&nbsp;&nbsp;&nbsp;&nbsp;B</div><div></div><div>C</div>
  </div>

  <!-- Oznaƒçen√≠ ≈ô√°dk≈Ø vlevo a vpravo -->
  <div id="left">
    <div>L</div>
    <div></div>
    <div>K</div>
    <div></div>
    <div>J</div>
    <div></div>
  </div>

  <!-- Hrac√≠ deska -->
  <div id="board"></div>

  <div id="right">
    <div></div>
    <div>D</div>
    <div></div>
    <div>E</div>
    <div></div>
    <div>F</div>
  </div>

  <!-- Oznaƒçen√≠ sloupc≈Ø dole -->
  <div id="bottom">
    <div></div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I</div><div></div><div>&nbsp;&nbsp;&nbsp;&nbsp;H</div><div></div><div>G</div><div></div>
  </div>

  <!-- Skimmery jako tlaƒç√≠tka -->
  <div id="skimmers">
    <div class="skimmer" onclick="showSkimmerOptions(0)">S1: <span id="skimmer1">0</span>/20</div>&nbsp;
    <div class="skimmer" onclick="showSkimmerOptions(1)">S2: <span id="skimmer2">0</span>/20</div>&nbsp;
    <div class="skimmer" onclick="showSkimmerOptions(2)">S3: <span id="skimmer3">0</span>/20</div>
  </div>
</div>
</br>
<!-- Tlaƒç√≠tka ReRoll -->
<div id="rerolls">
  <button id="reRoll1" onclick="reRollDice(1)" class="reroll-button">Hod 1</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  <button id="reRoll2" onclick="reRollDice(2)" class="reroll-button">Hod 2</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  <button id="reRoll3" onclick="reRollDice(3)" class="reroll-button">Hod 3</button>
</div>
</br>
<!-- Kostky -->
<div id="diceContainer">
  <div class="die" onclick="toggleDie(0)">1</div>
  <div class="die" onclick="toggleDie(1)">2</div>
  <div class="die" onclick="toggleDie(2)">3</div>
  <div class="die" onclick="toggleDie(3)">4</div>
  <div class="die" onclick="toggleDie(4)">5</div>
</div></br>


<table border="0">
<tr>
<td class="score"></td>
<td class="score" id="score">0</td>
</tr>
<tr>
<td class="highscore"></td>
<td class="highscore" id="high-score">0</td>
<tr>
<td class="highscore"></td>
<td class="highscore" id="final-rating"></td>
</tr>

</tr>
</table>


<!-- Tlaƒç√≠tko pro hod kostkami -->
<!-- <button id="rollButton" onclick="rollDice()">Hod kostkami</button> -->

<script type="text/javascript">
function handleButtonClick() {
            // Logika pro zobrazen√≠ n√°povƒõdy
            const option = prompt(`Hra Trezor - vyberte mo≈ænost:\n(zadejte ƒç√≠slo volby)\n1) Zobrazit n√°povƒõdu\n2) Ukonƒçit manu√°lnƒõ kolo\n3) Ukonƒçit manu√°lnƒõ hru`);
  if (option === "1") {
    showHelp();
  } else if (option === "2") {
    manualEndRound();
  } else if (option === "3") {
    calculateFinalScore();
    document.getElementById('score').innerText = `Deska ${boardId} - poƒçet bod≈Ø: ${score}`;
	updateGameStats(boardId, score);
    confirm("Hra skonƒçila!");
  }
}


	function selectBoard() {
  const option = prompt(`Hra Trezor - vyberte hern√≠ desku:\n(zadejte ƒç√≠slo desky 1 - 18)`);
  if (option === "1" || option === "01") {
    boardLayout = boardLayoutA;
    locks = locksA;  // Definice zamku pro desku A
    boardId = 'A'; // Nastav√≠me boardId pro desku A
  } else if (option === "2" || option === "02") {
    boardLayout = boardLayoutB;
    locks = locksB;  // Definice zamku pro desku B
    boardId = 'B'; // Nastav√≠me boardId pro desku B
  } else if (option === "3" || option === "03") {
    boardLayout = boardLayoutC;
    locks = locksB;  // Definice zamku pro desku C - stejna jako pro B
    boardId = 'C'; // Nastav√≠me boardId pro desku C
  } else if (option === "4" || option === "04") {
    boardLayout = boardLayoutD;
    locks = locksB;  // Definice zamku pro desku D - stejna jako pro B
    boardId = 'D'; // Nastav√≠me boardId pro desku D
  } else if (option === "5" || option === "05") {
    boardLayout = boardLayoutE;
    locks = locksB;  // Definice zamku pro desku E - stejna jako pro B
    boardId = 'E'; // Nastav√≠me boardId pro desku E
  } else if (option === "6" || option === "06") {
    boardLayout = boardLayoutF;
    locks = locksF;  //Definice zamku pro desku F
    boardId = 'F'; // Nastav√≠me boardId pro desku F
  } else if (option === "7" || option === "07") {
    boardLayout = boardLayoutG;
    locks = locksG;  //Definice zamku pro desku G
    boardId = 'G'; // Nastav√≠me boardId pro desku G
  } else if (option === "8" || option === "08") {
    boardLayout = boardLayoutH;
    locks = locksG;  //Definice zamku pro desku H - stejna jako pro G
    boardId = 'H'; // Nastav√≠me boardId pro desku H
  } else if (option === "9" || option === "09") {
    boardLayout = boardLayoutI;
    locks = locksI;  //Definice zamku pro desku I
    boardId = 'I'; // Nastav√≠me boardId pro desku I
  } else if (option === "10") {
    boardLayout = boardLayoutJ;
    locks = locksG;  //Definice zamku pro desku J - stejna jako pro G
    boardId = 'J'; // Nastav√≠me boardId pro desku J
	} else if (option === "11") {
    boardLayout = boardLayoutK;
    locks = locksG;  //Definice zamku pro desku K - stejna jako pro G
    boardId = 'K'; // Nastav√≠me boardId pro desku K
	} else if (option === "12") {
    boardLayout = boardLayoutL;
    locks = locksG;  //Definice zamku pro desku L - stejna jako pro G
    boardId = 'L'; // Nastav√≠me boardId pro desku L
	} else if (option === "13") {
    boardLayout = boardLayoutM;
    locks = locksB;  //Definice zamku pro desku M - stejna jako pro B
    boardId = 'M'; // Nastav√≠me boardId pro desku M
	} else if (option === "14") {
    boardLayout = boardLayoutN;
    locks = locksB;  //Definice zamku pro desku N - stejna jako pro B
    boardId = 'N'; // Nastav√≠me boardId pro desku N
	} else if (option === "15") {
    boardLayout = boardLayoutO;
    locks = locksO;  //Definice zamku pro desku O
    boardId = 'O'; // Nastav√≠me boardId pro desku O
	} else if (option === "16") {
    boardLayout = boardLayoutP;
    locks = locksP;  //Definice zamku pro desku P
    boardId = 'P'; // Nastav√≠me boardId pro desku P
	} else if (option === "17") {
    boardLayout = boardLayoutQ;
    locks = locksQ;  //Definice zamku pro desku Q
    boardId = 'Q'; // Nastav√≠me boardId pro desku Q
	} else if (option === "18") {
    boardLayout = boardLayoutR;
    locks = locksR;  //Definice zamku pro desku R
    boardId = 'R'; // Nastav√≠me boardId pro desku R
  } else {
    confirm("Neplatn√° volba. Zkuste to znovu.");
    selectBoard(); // Opakov√°n√≠ v√Ωbƒõru
  }
}

	


// Otev≈ôen√≠ mod√°ln√≠ho okna
function showHelp() {
  document.getElementById('helpModal').style.display = 'block';
}

function closeHelp() {
  document.getElementById('helpModal').style.display = 'none';
}


// Otev≈ôen√≠ mod√°ln√≠ho okna
function displayGameStatsInModal() {
  document.getElementById('statsModal').style.display = 'block';
}

function displayGameStatsInModal() {
  document.getElementById('statsModal').style.display = 'none';
}

// Zav≈ôen√≠ mod√°ln√≠ho okna, kdy≈æ u≈æivatel klikne mimo nƒõj
window.onclick = function(event) {
  if (event.target == document.getElementById('statsModal')) {
    document.getElementById('statsModal').style.display = 'none';
  } else if (event.target == document.getElementById('helpModal')) {
    document.getElementById('helpModal').style.display = 'none';
}
}


  const boardLayoutA = [

    ['20', 'x', '6', '15', '4', '13', '12'],
    ['x', '7', '2', 'S', 'x', '5', 'x'],
    ['10', '11', 'L', 'x', 'D', '9', '6'],
    ['x', '14', 'x', '5', 'x', '3', '2'],
    ['9', '15', '4', 'D', '3', 'x', '4'],
    ['x', '12', 'x', '6', '5', '10', 'x']
  ];


  const boardLayoutB = [

    ['19', 'x', '5', '14', '6', '13', 'x'],
    ['x', '7', '1', 'x', 'x', '3', 'x'],
    ['8', 'D', 'x', 'x', '10', '8', '4'],
    ['x', '14', 'x', '4', 'x', 'x', '6'],
    ['9', '16', 'S', '12', 'x', 'x', '1'],
    ['x', 'x', 'x', '3', '5', '11', 'x']
 ];


  const boardLayoutC = [

    ['19', 'x', '5', '17', '6', '13', 'x'],
    ['x', '8', '6', 'x', 'x', 'L', 'x'],
    ['10', '11', 'x', 'x', '10', '7', '6'],
    ['x', '16', 'x', '1', 'x', 'x', 'L'],
    ['D', '13', '4', '7', 'x', 'x', '3'],
    ['x', 'x', 'x', '5', 'S', '10', 'x']
 ];


  const boardLayoutD = [

    ['19', 'x', 'S', '13', '1', '14', 'x'],
    ['x', '9', '2', 'x', 'x', '1', 'x'],
    ['11', '8', 'x', 'x', '12', '9', '1'],
    ['x', '17', 'x', '6', 'x', 'x', '5'],
    ['7', '15', '6', '12', 'x', 'x', '2'],
    ['x', 'x', 'x', '1', '3', '7', 'x']
 ];


  const boardLayoutE = [

    ['21', 'x', '2', '18', '5', '14', 'x'],
    ['x', '8', '6', 'x', 'x', 'S', 'x'],
    ['9', '7', 'x', 'x', '8', '6', '2'],
    ['x', '18', 'x', '1', 'x', 'x', '4'],
    ['10', '16', '2', '9', 'x', 'x', '3'],
    ['x', 'x', 'x', 'L', '4', '11', 'x']
 ];


  const boardLayoutF = [

    ['23', 'x', '4', '14', 'L', '16', '7'],
    ['x', '8', 'S', 'x', 'x', 'L', 'x'],
    ['10', '9', 'x', 'x', '12', '7', '3'],
    ['x', '14', 'x', '6', 'x', '4', '1'],
    ['7', '15', 'L', '11', '3', 'x', '6'],
    ['x', 'x', 'x', '1', '2', '9', 'x']
 ];

  const boardLayoutG = [

    ['19', 'x', '2', '17', '3', '18', '12'],
    ['x', '12', '5', 'S', 'x', '1', 'x'],
    ['7', '10', '1', 'x', '9', '11', '2'],
    ['x', '15', 'x', 'L', 'x', '6', '1'],
    ['D', '16', 'S', '11', '3', 'x', '4'],
    ['x', '10', 'x', '3', '2', 'D', 'x']
 ];


  const boardLayoutH = [

    ['23', 'x', '6', '17', 'L', '16', '12'],
    ['x', 'D', 'L', '3', 'x', 'S', 'x'],
    ['8', '14', '1', 'x', '11', '12', '6'],
    ['x', '9', 'x', 'L', 'x', '3', '4'],
    ['11', '15', '2', '10', '1', 'x', '5'],
    ['x', '8', 'x', '1', '4', '7', 'x']
 ];



  const boardLayoutI = [

    ['21', 'x', '3', '15', 'L', '13', 'x'],
    ['x', 'D', '6', 'x', 'x', '3', 'x'],
    ['11', '7', '4', 'x', '6', '8', '3'],
    ['x', '16', 'x', '5', 'x', 'x', '4'],
    ['9', '15', '5', '8', '2', 'x', '6'],
    ['x', 'D', 'x', '4', '1', '9', 'x']
 ];


  const boardLayoutJ = [

    ['23', 'x', '6', '14', '1', '15', '12'],
    ['x', '10', '2', '5', 'x', '3', 'x'],
    ['8', '14', '1', 'x', '7', '10', 'L'],
    ['x', '8', 'x', '3', 'x', '2', '1'],
    ['9', '16', '3', '12', 'L', 'x', '4'],
    ['x', 'D', 'x', '4', 'S', '9', 'x']
 ];


  const boardLayoutK = [

    ['22', 'x', '2', '14', '5', '16', 'D'],
    ['x', '7', '4', '2', 'x', 'L', 'x'],
    ['8', '16', '3', 'x', '7', '11', 'L'],
    ['x', 'D', 'x', '6', 'x', '3', '2'],
    ['9', '17', '1', 'D', '1', 'x', '6'],
    ['x', '8', 'x', 'S', '2', '12', 'x']
 ];

  const boardLayoutL = [

    ['19', 'x', '5', '17', '3', '14', 'D'],
    ['x', '8', '3', '4', 'x', '1', 'x'],
    ['7', '13', '1', 'x', '10', '11', '3'],
    ['x', 'D', 'x', '1', 'x', '5', '4'],
    ['10', '16', '3', 'D', 'L', 'x', '1'],
    ['x', '10', 'x', '6', '4', '12', 'x']
 ];

  const boardLayoutM = [

    ['20', 'x', 'S', '14', 'L', '16', 'x'],
    ['x', '12', '5', 'x', 'x', 'L', 'x'],
    ['7', '11', 'x', 'x', '8', '7', '3'],
    ['x', '14', 'x', '1', 'x', 'x', '5'],
    ['D', '16', '1', '10', 'x', 'x', '4'],
    ['x', 'x', 'x', 'S', '2', '10', 'x']

 ];

  const boardLayoutN = [

    ['19', 'x', '4', '13', 'S', '17', 'x'],
    ['x', '9', '2', 'x', 'x', '3', 'x'],
    ['8', '14', 'x', 'x', '9', '11', 'L'],
    ['x', '15', 'x', 'S', 'x', 'x', '2'],
    ['12', '10', '5', '9', 'x', 'x', '3'],
    ['x', 'x', 'x', '3', '5', '10', 'x']
 ];

  const boardLayoutO = [

    ['23', 'x', '6', '14', '2', '16', '7'],
    ['x', 'D', '2', '4', 'x', '3', 'x'],
    ['7', '17', '1', 'x', '7', '9', '5'],
    ['x', '12', 'x', '6', 'x', 'x', '4'],
    ['D', '15', '5', '8', 'x', 'x', '3'],
    ['x', 'x', 'x', '5', '1', 'D', 'x']
 ];

  const boardLayoutP = [

    ['21', 'x', '2', '17', 'L', '15', '9'],
    ['x', '10', '3', 'S', 'x', '2', 'x'],
    ['D', '11', 'x', 'x', '9', '10', '2'],
    ['x', '14', 'x', '6', 'x', '4', 'S'],
    ['12', '15', 'L', '7', 'x', 'x', '4'],
    ['x', 'x', 'x', '6', '5', '7', 'x']
 ];

  const boardLayoutQ = [

    ['24', 'x', '1', '14', '2', '16', 'x'],
    ['x', '10', '1', 'L', 'x', '3', 'x'],
    ['7', '17', '6', 'x', '12', '11', 'S'],
    ['x', '9', 'x', '4', 'x', 'x', '5'],
    ['9', '18', '3', 'D', 'x', 'x', '6'],
    ['x', '9', 'x', '5', '1', '8', 'x']
 ];

  const boardLayoutR = [

    ['20', 'x', '4', '15', '3', '17', 'x'],
    ['x', '9', '9', 'L', 'x', '3', 'x'],
    ['12', '18', 'x', 'x', '9', '19', '2'],
    ['x', '11', 'x', 'L', 'x', '1', '5'],
    ['D', '17', 'S', '11', '4', 'x', '1'],
    ['x', '10', 'x', 'S', '5', '11', 'x']
 ];


let dice = [0, 0, 0, 0, 0]; // Hodnoty kostek
let skimmers = [0, 0, 0]; // Hodnoty pro skimmery
let selectedDice = []; // Uchov√°n√≠ vybran√Ωch kostek
let virtualDice = null; // Uchov√°n√≠ virtu√°ln√≠ kostky ze skimmeru
let currentRound = 1; // Aktu√°ln√≠ kolo
let score = 0; // Body hr√°ƒçe
let unusedSkimmers = 0; // Pocet nepou≈æit√Ωch Skimmer≈Ø
const totalRounds = 12; // Poƒçet kol

const locksA = [
	 { name: "A", coordinates: [{ row: 0, col: 2 }, { row: 1, col: 2 }, { row: 2, col: 2 }, { row: 4, col: 2 }] },
	 { name: "B", coordinates: [{ row: 0, col: 4 }, { row: 2, col: 4 }, { row: 4, col: 4 }, { row: 5, col: 4 }] },
	 { name: "C", coordinates: [{ row: 0, col: 6 }, { row: 2, col: 6 }, { row: 3, col: 6 }, { row: 4, col: 6 }] },
	 { name: "D", coordinates: [{ row: 1, col: 1 }, { row: 1, col: 2 }, { row: 1, col: 3 }, { row: 1, col: 5 }] },
	 { name: "E", coordinates: [{ row: 3, col: 1 }, { row: 3, col: 3 }, { row: 3, col: 5 }, { row: 3, col: 6 }] },
	 { name: "F", coordinates: [{ row: 5, col: 1 }, { row: 5, col: 3 }, { row: 5, col: 4 }, { row: 5, col: 5 }] },
	 { name: "G", coordinates: [{ row: 0, col: 5 }, { row: 1, col: 5 }, { row: 2, col: 5 }, { row: 3, col: 5 }, { row: 5, col: 5 }] },
	 { name: "H", coordinates: [{ row: 0, col: 3 }, { row: 1, col: 3 }, { row: 3, col: 3 }, { row: 4, col: 3 }, { row: 5, col: 3 }] },
	 { name: "I", coordinates: [{ row: 1, col: 1 }, { row: 2, col: 1 }, { row: 3, col: 1 }, { row: 4, col: 1 }, { row: 5, col: 1 }] },
	 { name: "J", coordinates: [{ row: 4, col: 0 }, { row: 4, col: 1 }, { row: 4, col: 2 }, { row: 4, col: 3 }, { row: 4, col: 4 }, { row: 4, col: 6 }] },
	 { name: "K", coordinates: [{ row: 2, col: 0 }, { row: 2, col: 1 }, { row: 2, col: 2 }, { row: 2, col: 4 }, { row: 2, col: 5 }, { row: 2, col: 6 }] },
	 { name: "L", coordinates: [{ row: 0, col: 0 }, { row: 0, col: 2 }, { row: 0, col: 3 }, { row: 0, col: 4 }, { row: 0, col: 5 }, { row: 0, col: 6 }] }
]; 

const locksB = [
	 { name: "A", coordinates: [{ row: 0, col: 2 }, { row: 1, col: 2 }, { row: 4, col: 2 }] },
	 { name: "B", coordinates: [{ row: 0, col: 4 }, { row: 2, col: 4 }, { row: 5, col: 4 }] },
	 { name: "C", coordinates: [{ row: 2, col: 6 }, { row: 3, col: 6 }, { row: 4, col: 6 }] },
	 { name: "D", coordinates: [{ row: 1, col: 1 }, { row: 1, col: 2 }, { row: 1, col: 5 }] },
	 { name: "E", coordinates: [{ row: 3, col: 1 }, { row: 3, col: 3 }, { row: 3, col: 6 }] },
	 { name: "F", coordinates: [{ row: 5, col: 3 }, { row: 5, col: 4 }, { row: 5, col: 5 }] },
	 { name: "G", coordinates: [{ row: 0, col: 5 }, { row: 1, col: 5 }, { row: 2, col: 5 }, { row: 5, col: 5 }] },
	 { name: "H", coordinates: [{ row: 0, col: 3 }, { row: 3, col: 3 }, { row: 4, col: 3 }, { row: 5, col: 3 }] },
	 { name: "I", coordinates: [{ row: 1, col: 1 }, { row: 2, col: 1 }, { row: 3, col: 1 }, { row: 4, col: 1 }] },
	 { name: "J", coordinates: [{ row: 4, col: 0 }, { row: 4, col: 1 }, { row: 4, col: 2 }, { row: 4, col: 3 }, { row: 4, col: 6 }] },
	 { name: "K", coordinates: [{ row: 2, col: 0 }, { row: 2, col: 1 }, { row: 2, col: 4 }, { row: 2, col: 5 }, { row: 2, col: 6 }] },
	 { name: "L", coordinates: [{ row: 0, col: 0 }, { row: 0, col: 2 }, { row: 0, col: 3 }, { row: 0, col: 4 }, { row: 0, col: 5 }] }
]; 

const locksF = [
	 { name: "A", coordinates: [{ row: 0, col: 2 }, { row: 1, col: 2 }, { row: 4, col: 2 }] },
	 { name: "B", coordinates: [{ row: 0, col: 4 }, { row: 2, col: 4 }, { row: 4, col: 4 }, { row: 5, col: 4 }] },
	 { name: "C", coordinates: [{ row: 0, col: 6 }, { row: 2, col: 6 }, { row: 3, col: 6 }, { row: 4, col: 6 }] },
	 { name: "D", coordinates: [{ row: 1, col: 1 }, { row: 1, col: 2 }, { row: 1, col: 5 }] },
	 { name: "E", coordinates: [{ row: 3, col: 1 }, { row: 3, col: 3 }, { row: 3, col: 5 }, { row: 3, col: 6 }] },
	 { name: "F", coordinates: [{ row: 5, col: 3 }, { row: 5, col: 4 }, { row: 5, col: 5 }] },
	 { name: "G", coordinates: [{ row: 0, col: 5 }, { row: 1, col: 5 }, { row: 2, col: 5 }, { row: 5, col: 5 }] },
	 { name: "H", coordinates: [{ row: 0, col: 3 }, { row: 3, col: 3 }, { row: 4, col: 3 }, { row: 5, col: 3 }] },
	 { name: "I", coordinates: [{ row: 1, col: 1 }, { row: 2, col: 1 }, { row: 3, col: 1 }, { row: 4, col: 1 }] },
	 { name: "J", coordinates: [{ row: 4, col: 0 }, { row: 4, col: 1 }, { row: 4, col: 2 }, { row: 4, col: 3 }, { row: 4, col: 4 }, { row: 4, col: 6 }] },
	 { name: "K", coordinates: [{ row: 2, col: 0 }, { row: 2, col: 1 }, { row: 2, col: 4 }, { row: 2, col: 5 }, { row: 2, col: 6 }] },
	 { name: "L", coordinates: [{ row: 0, col: 0 }, { row: 0, col: 2 }, { row: 0, col: 3 }, { row: 0, col: 4 }, { row: 0, col: 5 }, { row: 0, col: 6 }] }
]; 


const locksG = [
	 { name: "A", coordinates: [{ row: 0, col: 2 }, { row: 1, col: 2 }, { row: 2, col: 2 }, { row: 4, col: 2 }] },
	 { name: "B", coordinates: [{ row: 0, col: 4 }, { row: 2, col: 4 }, { row: 4, col: 4 }, { row: 5, col: 4 }] },
	 { name: "C", coordinates: [{ row: 0, col: 6 }, { row: 2, col: 6 }, { row: 3, col: 6 }, { row: 4, col: 6 }] },
	 { name: "D", coordinates: [{ row: 1, col: 1 }, { row: 1, col: 2 }, { row: 1, col: 3 }, { row: 1, col: 5 }] },
	 { name: "E", coordinates: [{ row: 3, col: 1 }, { row: 3, col: 3 }, { row: 3, col: 5 }, { row: 3, col: 6 }] },
	 { name: "F", coordinates: [{ row: 5, col: 1 }, { row: 5, col: 3 }, { row: 5, col: 4 }, { row: 5, col: 5 }] },
	 { name: "G", coordinates: [{ row: 0, col: 5 }, { row: 1, col: 5 }, { row: 2, col: 5 }, { row: 3, col: 5 }, { row: 5, col: 5 }] },
	 { name: "H", coordinates: [{ row: 0, col: 3 }, { row: 1, col: 3 }, { row: 3, col: 3 }, { row: 4, col: 3 }, { row: 5, col: 3 }] },
	 { name: "I", coordinates: [{ row: 1, col: 1 }, { row: 2, col: 1 }, { row: 3, col: 1 }, { row: 4, col: 1 }, { row: 5, col: 1 }] },
	 { name: "J", coordinates: [{ row: 4, col: 0 }, { row: 4, col: 1 }, { row: 4, col: 2 }, { row: 4, col: 3 }, { row: 4, col: 4 }, { row: 4, col: 6 }] },
	 { name: "K", coordinates: [{ row: 2, col: 0 }, { row: 2, col: 1 }, { row: 2, col: 2 }, { row: 2, col: 4 }, { row: 2, col: 5 }, { row: 2, col: 6 }] },
	 { name: "L", coordinates: [{ row: 0, col: 0 }, { row: 0, col: 2 }, { row: 0, col: 3 }, { row: 0, col: 4 }, { row: 0, col: 5 }, { row: 0, col: 6 }] }
]; 


const locksI = [
	 { name: "A", coordinates: [{ row: 0, col: 2 }, { row: 1, col: 2 }, { row: 2, col: 2 }, { row: 4, col: 2 }] },
	 { name: "B", coordinates: [{ row: 0, col: 4 }, { row: 2, col: 4 }, { row: 4, col: 4 }, { row: 5, col: 4 }] },
	 { name: "C", coordinates: [{ row: 2, col: 6 }, { row: 3, col: 6 }, { row: 4, col: 6 }] },
	 { name: "D", coordinates: [{ row: 1, col: 1 }, { row: 1, col: 2 }, { row: 1, col: 5 }] },
	 { name: "E", coordinates: [{ row: 3, col: 1 }, { row: 3, col: 3 }, { row: 3, col: 6 }] },
	 { name: "F", coordinates: [{ row: 5, col: 1 }, { row: 5, col: 3 }, { row: 5, col: 4 }, { row: 5, col: 5 }] },
	 { name: "G", coordinates: [{ row: 0, col: 5 }, { row: 1, col: 5 }, { row: 2, col: 5 }, { row: 5, col: 5 }] },
	 { name: "H", coordinates: [{ row: 0, col: 3 }, { row: 3, col: 3 }, { row: 4, col: 3 }, { row: 5, col: 3 }] },
	 { name: "I", coordinates: [{ row: 1, col: 1 }, { row: 2, col: 1 }, { row: 3, col: 1 }, { row: 4, col: 1 }, { row: 5, col: 1 }] },
	 { name: "J", coordinates: [{ row: 4, col: 0 }, { row: 4, col: 1 }, { row: 4, col: 2 }, { row: 4, col: 3 }, { row: 4, col: 4 }, { row: 4, col: 6 }] },
	 { name: "K", coordinates: [{ row: 2, col: 0 }, { row: 2, col: 1 }, { row: 2, col: 2 }, { row: 2, col: 4 }, { row: 2, col: 5 }, { row: 2, col: 6 }] },
	 { name: "L", coordinates: [{ row: 0, col: 0 }, { row: 0, col: 2 }, { row: 0, col: 3 }, { row: 0, col: 4 }, { row: 0, col: 5 }] }
]; 

const locksO = [
	 { name: "A", coordinates: [{ row: 0, col: 2 }, { row: 1, col: 2 }, { row: 2, col: 2 }, { row: 4, col: 2 }] },
	 { name: "B", coordinates: [{ row: 0, col: 4 }, { row: 2, col: 4 }, { row: 5, col: 4 }] },
	 { name: "C", coordinates: [{ row: 0, col: 6 }, { row: 2, col: 6 }, { row: 3, col: 6 }, { row: 4, col: 6 }] },
	 { name: "D", coordinates: [{ row: 1, col: 1 }, { row: 1, col: 2 }, { row: 1, col: 3 }, { row: 1, col: 5 }] },
	 { name: "E", coordinates: [{ row: 3, col: 1 }, { row: 3, col: 3 }, { row: 3, col: 6 }] },
	 { name: "F", coordinates: [{ row: 5, col: 3 }, { row: 5, col: 4 }, { row: 5, col: 5 }] },
	 { name: "G", coordinates: [{ row: 0, col: 5 }, { row: 1, col: 5 }, { row: 2, col: 5 }, { row: 5, col: 5 }] },
	 { name: "H", coordinates: [{ row: 0, col: 3 }, { row: 1, col: 3 }, { row: 3, col: 3 }, { row: 4, col: 3 }, { row: 5, col: 3 }] },
	 { name: "I", coordinates: [{ row: 1, col: 1 }, { row: 2, col: 1 }, { row: 3, col: 1 }, { row: 4, col: 1 }] },
	 { name: "J", coordinates: [{ row: 4, col: 0 }, { row: 4, col: 1 }, { row: 4, col: 2 }, { row: 4, col: 3 }, { row: 4, col: 6 }] },
	 { name: "K", coordinates: [{ row: 2, col: 0 }, { row: 2, col: 1 }, { row: 2, col: 2 }, { row: 2, col: 4 }, { row: 2, col: 5 }, { row: 2, col: 6 }] },
	 { name: "L", coordinates: [{ row: 0, col: 0 }, { row: 0, col: 2 }, { row: 0, col: 3 }, { row: 0, col: 4 }, { row: 0, col: 5 }, { row: 0, col: 6 }] }
]; 

const locksP = [
	 { name: "A", coordinates: [{ row: 0, col: 2 }, { row: 1, col: 2 }, { row: 4, col: 2 }] },
	 { name: "B", coordinates: [{ row: 0, col: 4 }, { row: 2, col: 4 }, { row: 5, col: 4 }] },
	 { name: "C", coordinates: [{ row: 0, col: 6 }, { row: 2, col: 6 }, { row: 3, col: 6 }, { row: 4, col: 6 }] },
	 { name: "D", coordinates: [{ row: 1, col: 1 }, { row: 1, col: 2 }, { row: 1, col: 3 }, { row: 1, col: 5 }] },
	 { name: "E", coordinates: [{ row: 3, col: 1 }, { row: 3, col: 3 }, { row: 3, col: 5 },  { row: 3, col: 6 }] },
	 { name: "F", coordinates: [{ row: 5, col: 3 }, { row: 5, col: 4 }, { row: 5, col: 5 }] },
	 { name: "G", coordinates: [{ row: 0, col: 5 }, { row: 1, col: 5 }, { row: 2, col: 5 }, { row: 3, col: 5 }, { row: 5, col: 5 }] },
	 { name: "H", coordinates: [{ row: 0, col: 3 }, { row: 1, col: 3 }, { row: 3, col: 3 }, { row: 4, col: 3 }, { row: 5, col: 3 }] },
	 { name: "I", coordinates: [{ row: 1, col: 1 }, { row: 2, col: 1 }, { row: 3, col: 1 }, { row: 4, col: 1 }] },
	 { name: "J", coordinates: [{ row: 4, col: 0 }, { row: 4, col: 1 }, { row: 4, col: 2 }, { row: 4, col: 3 }, { row: 4, col: 6 }] },
	 { name: "K", coordinates: [{ row: 2, col: 0 }, { row: 2, col: 1 }, { row: 2, col: 4 }, { row: 2, col: 5 }, { row: 2, col: 6 }] },
	 { name: "L", coordinates: [{ row: 0, col: 0 }, { row: 0, col: 2 }, { row: 0, col: 3 }, { row: 0, col: 4 }, { row: 0, col: 5 }, { row: 0, col: 6 }] }
]; 

const locksQ = [
	 { name: "A", coordinates: [{ row: 0, col: 2 }, { row: 1, col: 2 }, { row: 4, col: 2 }] },
	 { name: "B", coordinates: [{ row: 0, col: 4 }, { row: 2, col: 4 }, { row: 5, col: 4 }] },
	 { name: "C", coordinates: [{ row: 2, col: 6 }, { row: 3, col: 6 }, { row: 4, col: 6 }] },
	 { name: "D", coordinates: [{ row: 1, col: 1 }, { row: 1, col: 2 }, { row: 1, col: 3 }, { row: 1, col: 5 }] },
	 { name: "E", coordinates: [{ row: 3, col: 1 }, { row: 3, col: 3 }, { row: 3, col: 6 }] },
	 { name: "F", coordinates: [{ row: 5, col: 1 }, { row: 5, col: 3 }, { row: 5, col: 4 }, { row: 5, col: 5 }] },
	 { name: "G", coordinates: [{ row: 0, col: 5 }, { row: 1, col: 5 }, { row: 2, col: 5 }, { row: 5, col: 5 }] },
	 { name: "H", coordinates: [{ row: 0, col: 3 }, { row: 1, col: 3 }, { row: 3, col: 3 }, { row: 4, col: 3 }, { row: 5, col: 3 }] },
	 { name: "I", coordinates: [{ row: 1, col: 1 }, { row: 2, col: 1 }, { row: 3, col: 1 }, { row: 4, col: 1 }, { row: 5, col: 1 }] },
	 { name: "J", coordinates: [{ row: 4, col: 0 }, { row: 4, col: 1 }, { row: 4, col: 2 }, { row: 4, col: 3 }, { row: 4, col: 6 }] },
	 { name: "K", coordinates: [{ row: 2, col: 0 }, { row: 2, col: 1 }, { row: 2, col: 2 }, { row: 2, col: 4 }, { row: 2, col: 5 }, { row: 2, col: 6 }] },
	 { name: "L", coordinates: [{ row: 0, col: 0 }, { row: 0, col: 2 }, { row: 0, col: 3 }, { row: 0, col: 4 }, { row: 0, col: 5 }] }
]; 

const locksR = [
	 { name: "A", coordinates: [{ row: 0, col: 2 }, { row: 1, col: 2 }, { row: 4, col: 2 }] },
	 { name: "B", coordinates: [{ row: 0, col: 4 }, { row: 2, col: 4 }, { row: 4, col: 4 }, { row: 5, col: 4 }] },
	 { name: "C", coordinates: [{ row: 2, col: 6 }, { row: 3, col: 6 }, { row: 4, col: 6 }] },
	 { name: "D", coordinates: [{ row: 1, col: 1 }, { row: 1, col: 2 }, { row: 1, col: 3 }, { row: 1, col: 5 }] },
	 { name: "E", coordinates: [{ row: 3, col: 1 }, { row: 3, col: 3 }, { row: 3, col: 5 }, { row: 3, col: 6 }] },
	 { name: "F", coordinates: [{ row: 5, col: 1 }, { row: 5, col: 3 }, { row: 5, col: 4 }, { row: 5, col: 5 }] },
	 { name: "G", coordinates: [{ row: 0, col: 5 }, { row: 1, col: 5 }, { row: 2, col: 5 }, { row: 3, col: 5 }, { row: 5, col: 5 }] },
	 { name: "H", coordinates: [{ row: 0, col: 3 }, { row: 1, col: 3 }, { row: 3, col: 3 }, { row: 4, col: 3 }, { row: 5, col: 3 }] },
	 { name: "I", coordinates: [{ row: 1, col: 1 }, { row: 2, col: 1 }, { row: 3, col: 1 }, { row: 4, col: 1 }, { row: 5, col: 1 }] },
	 { name: "J", coordinates: [{ row: 4, col: 0 }, { row: 4, col: 1 }, { row: 4, col: 2 }, { row: 4, col: 3 }, { row: 4, col: 4 }, { row: 4, col: 6 }] },
	 { name: "K", coordinates: [{ row: 2, col: 0 }, { row: 2, col: 1 }, { row: 2, col: 4 }, { row: 2, col: 5 }, { row: 2, col: 6 }] },
	 { name: "L", coordinates: [{ row: 0, col: 0 }, { row: 0, col: 2 }, { row: 0, col: 3 }, { row: 0, col: 4 }, { row: 0, col: 5 }] }
]; 


const lockPoints = { A: 1, B: 1, C: 1, D: 1, E: 1, F: 1, G: 2, H: 2, I: 2, J: 3, K: 3, L: 3 }; // Body za z√°mky


  // Vytvo≈ôen√≠ hern√≠ desky
  function createBoard() {
    const boardDiv = document.getElementById('board');

if (!boardDiv) {
    console.error("Chyba: Element s ID 'board' nebyl nalezen.");
    alert("Chyba: Nemohu naj√≠t prvek pro hrac√≠ desku.");
    return;
  }
  boardDiv.innerHTML = ''; // Odstranƒõn√≠ star√©ho obsahu

    for (let row = 0; row < boardLayout.length; row++) {
      for (let col = 0; col < boardLayout[row].length; col++) {
        const cellValue = boardLayout[row][col];
        const cell = document.createElement('div');
        cell.classList.add('cell');
        cell.id = `cell-${row}-${col}`;
        cell.innerText = cellValue;

        if (cellValue === 'x') {
          cell.classList.add('disabled');
        } else {
          cell.onclick = () => markCell(row, col, cellValue); 
        }

        if (cellValue === 'L') cell.classList.add('odd');
        else if (cellValue === 'S') cell.classList.add('even');
        else if (cellValue === 'D') cell.classList.add('double');

        boardDiv.appendChild(cell);
      }
    }
  }


// V√Ωchoz√≠ struktura statistik
const defaultStats = {
  totalGames: 0,
  boards: {}, // Statistiky pro ka≈ædou desku
};

// Naƒçten√≠ statistik z localStorage
function loadGameStats() {
  const stats = localStorage.getItem('gameStats');
  return stats ? JSON.parse(stats) : { ...defaultStats };
}

// Ulo≈æen√≠ statistik do localStorage
function saveGameStats(stats) {
  localStorage.setItem('gameStats', JSON.stringify(stats));
}

// Aktualizace statistik po ukonƒçen√≠ hry
function updateGameStats(boardId, score) {
  const stats = loadGameStats();

  // Celkov√© statistiky
  stats.totalGames += 1;

  // Statistiky pro konkr√©tn√≠ desku
  if (!stats.boards[boardId]) {
    stats.boards[boardId] = { gamesPlayed: 0, totalScore: 0, highestScore: 0 };
  }

  const boardStats = stats.boards[boardId];
  boardStats.gamesPlayed += 1;
  boardStats.totalScore += score;
  if (score > boardStats.highestScore) {
    boardStats.highestScore = score;
  }

  saveGameStats(stats);
}

	//Zajist√≠me, ≈æe getHighestScoreBoard pou≈æ√≠v√° loadHighScore:
function getHighestScoreBoard(stats) {
  let highestScore = -Infinity;
  let bestBoardId = '';

  Object.keys(stats.boards).forEach(boardId => {
    const highScore = loadHighScore(boardId); // Pou≈æijeme `loadHighScore`
    if (highScore > highestScore) {
      highestScore = highScore;
      bestBoardId = boardId;
    }
  });

  return { bestBoardId, highestScore };
}


function displayGameStatsInModal() {
  const stats = loadGameStats();

  const totalStatsDiv = document.getElementById('totalStats');
  totalStatsDiv.innerHTML = `<p><strong>Celkov√Ω poƒçet her:</strong> ${stats.totalGames}</p>`;

  // Z√≠sk√°n√≠ desky s nejvy≈°≈°√≠m sk√≥re
  const { bestBoardId, highestScore } = getHighestScoreBoard(stats);
  totalStatsDiv.innerHTML += `<p><strong>Nejvy≈°≈°√≠ sk√≥re:</strong> ${highestScore} (Deska ${bestBoardId})</p>`;

  const boardStatsDiv = document.getElementById('boardStats');
  boardStatsDiv.innerHTML = '<h3>Statistiky jednotliv√Ωch desek</h3>';

  // Z√≠sk√°me v≈°echny desky, se≈ôad√≠me je podle `boardId` abecednƒõ
  const sortedBoards = Object.keys(stats.boards).sort();

  sortedBoards.forEach(boardId => {
    const boardStats = stats.boards[boardId];
    const highScore = loadHighScore(boardId); // Naƒçten√≠ nejvy≈°≈°√≠ho sk√≥re
    const averageScore = (boardStats.totalScore / boardStats.gamesPlayed).toFixed(2);

    boardStatsDiv.innerHTML += `
      <div>
        <strong>Deska ${boardId}:</strong>
		<ul>
        <li>poƒçet her: ${boardStats.gamesPlayed}</li>
        <li>pr≈Ømƒõrn√© sk√≥re: ${averageScore}</li>
        <li>nejvy≈°≈°√≠ sk√≥re: ${boardStats.highestScore}</li>
		</ul>
      </div>
      </br>
    `;
  });

  const modal = document.getElementById('statsModal');
  modal.style.display = 'block';
}


// Zav≈ôen√≠ modal okna
function closeStatsModal() {
  const modal = document.getElementById('statsModal');
  modal.style.display = 'none';
}


function loadHighScore(boardId) {
  const savedScore = localStorage.getItem(`highScore_${boardId}`);
  console.log(`Naƒç√≠t√°n√≠ nejvy≈°≈°√≠ho sk√≥re pro desku ${boardId}:`, savedScore); // P≈ôid√°no logov√°n√≠
  return savedScore ? parseInt(savedScore, 10) : 0;
}

function saveHighScore(score, boardId) {
  localStorage.setItem(`highScore_${boardId}`, score);
  console.log(`Ukl√°d√°n√≠ nov√©ho nejvy≈°≈°√≠ho sk√≥re pro desku ${boardId}:`, score); // P≈ôid√°no logov√°n√≠
}



// Funkce pro z√≠sk√°n√≠ skuteƒçn√© barvy pozad√≠ elementu
function getBackgroundColor(element) {
    return window.getComputedStyle(element, null).getPropertyValue('background-color');
}

// Funkce pro hod kostkami
function rollDice() {
  dice = Array.from({ length: 5 }, () => Math.floor(Math.random() * 6) + 1);
  const diceElements = document.querySelectorAll('.die');
  dice.forEach((value, index) => {
    diceElements[index].innerText = value;
    diceElements[index].classList.remove('clicked', 'used'); // Reset oznaƒçen√≠ kostek p≈ôi hodu
  });
  selectedDice = []; // Reset vybran√Ωch kostek p≈ôi hodu
}

// Funkce pro zah√°jen√≠ nov√©ho kola
function startRound() {
      // Vyƒçi≈°tƒõn√≠ p≈ôedchoz√≠ho zv√Ωraznƒõn√≠
  locks.forEach(lock => {
    lock.coordinates.forEach(({ row, col }) => {
      const cell = document.getElementById(`cell-${row}-${col}`);
      cell.classList.remove('highlight', 'highlight-empty', 'highlight-filled');
      cell.style.color = ''; // Resetuje barvu textu
      cell.style.fontWeight = ''; // Resetuje tucneƒçn√© pismo textu
	const rating = getRating(score);
 	document.getElementById('final-rating').innerHTML = ``;
    });
  });
const currentLock = locks[currentRound - 1];
const lockName = currentLock.name;

// Zv√Ωraznƒõn√≠ aktu√°ln√≠ho z√°mku
  currentLock.coordinates.forEach(({ row, col }) => {
    const cell = document.getElementById(`cell-${row}-${col}`);
    const backgroundColor = getBackgroundColor(cell);
    if (backgroundColor === 'rgb(75, 76, 75)') {
            // Pokud je barva pozad√≠ bu≈àky ≈°ed√° (rgb(128, 128, 128))
            
            cell.style.color = 'yellow'; // Nastaven√≠ ≈ælut√© barvy textu pro bu≈àky s ≈°ed√Ωm pozad√≠m
            cell.style.fontWeight = 'bold'; // Nastaven√≠ tuƒçn√©ho p√≠sma pro bu≈àky s ≈°ed√Ωm pozad√≠m
        } else {
            // Pokud je bu≈àka nevyplnƒõn√°
            cell.classList.add('highlight-empty');
        }
    
    
   
  });
  if (currentRound > totalRounds) {
    alert("Hra skonƒçila!");
    return;
  }
  alert(`Zahajuje se kolo ${currentRound}: ≈òe≈°√≠me z√°mek ${currentLock.name} na desce ${boardId}`);
}



// Kontrola, zda byly v≈°echny kostky pou≈æity
function checkAllDiceUsed() {
  const allUsed = Array.from(document.querySelectorAll('.die')).every(die => die.classList.contains('used'));
  if (allUsed) {
    endRound();
  }
}


function getRating(score) {
  if (score < 10) {
    return "Jde≈° do vƒõzen√≠";
  } else if (score <= 12) {
    return "Lapka&nbsp;&nbsp;&#11088;";
  } else if (score <= 15) {
    return "Kaps√°≈ô&nbsp;&nbsp;&#11088;&#11088;";
  } else if (score <= 18) {
    return "Zlodƒõj&nbsp;&nbsp;&#11088;&#11088;&#11088;";
  } else if (score <= 21) {
    return "Bankovn√≠ lupiƒç&nbsp;&nbsp;&#11088;&#11088;&#11088;&#11088;";
  } else {
    return "Ars√®ne Lupin&nbsp;&nbsp;&#11088;&#11088;&#11088;&#11088;&#11088;";
  }
}


// Funkce pro v√Ωpoƒçet z√°vƒõreƒçn√©ho sk√≥re vƒçetnƒõ nepou≈æit√Ωch skimmer≈Ø
function calculateFinalScore() {
  let unusedSkimmers = 0;

  document.querySelectorAll('.skimmer').forEach((skimmer) => {
    if (!skimmer.classList.contains('disabled')) {
      unusedSkimmers++;
    }
  });

  // P≈ôiƒçten√≠ bod≈Ø za nepou≈æit√© skimmery
  score += unusedSkimmers;

  confirm(`Koneƒçn√© sk√≥re: ${score} (zahrnuje poƒçet bod≈Ø za nepou≈æit√© ≈†perh√°ky: ${unusedSkimmers})`);
	// V√Ωpoƒçet hodnocen√≠ na z√°kladƒõ sk√≥re
  const rating = getRating(score);
 document.getElementById('final-rating').innerHTML = `Hodnocen√≠: ${rating}`;


  // Naƒçtƒõte nejvy≈°≈°√≠ sk√≥re pro aktu√°ln√≠ desku
  const highScore = loadHighScore(boardId);
  console.log(`Porovn√°n√≠ aktu√°ln√≠ho sk√≥re ${score} s nejvy≈°≈°√≠m sk√≥re ${highScore} pro desku ${boardId}`);

  if (score > highScore) {
    saveHighScore(score, boardId);
    confirm(`Gratulujeme! Dos√°hli jste nov√©ho vysok√©ho sk√≥re: ${score}`);
  }

  // Aktualizace zobrazen√≠ sk√≥re na obrazovce
  document.getElementById('score').innerText = `Deska ${boardId} - poƒçet bod≈Ø: ${score}`;
  document.getElementById('high-score').innerText = `Deska ${boardId} - nejvy≈°≈°√≠ dosa≈æen√© sk√≥re: ${Math.max(score, highScore)}`;

  // Aktualizace statistik
  updateGameStats(boardId, score);
}



// Funkce pro manu√°ln√≠ ukonƒçen√≠ kola, pokud nelze pou≈æ√≠t v≈°echny kostky
function manualEndRound() {
  const lock = locks[currentRound - 1];

  // Zkontrolujeme, zda jsou v≈°echny relevantn√≠ bu≈àky pro tento z√°mek vyplnƒõny
  const allCellsFilled = lock.coordinates.every(({ row, col }) => {
    const cell = document.getElementById(`cell-${row}-${col}`);
    return cell.classList.contains('clicked');
  });

  if (allCellsFilled) {
    // Oznaƒç√≠me v≈°echny bu≈àky tohoto z√°mku jako 'O' v hern√≠ desce
    lock.coordinates.forEach(({ row, col }) => {
      const cell = document.getElementById(`cell-${row}-${col}`);
      cell.classList.add('opened'); // P≈ôid√°me t≈ô√≠du 'opened' pro vizu√°ln√≠ oznaƒçen√≠
      cell.textContent = 'o'; // Zmƒõn√≠me obsah bu≈àky na 'o'
    });
    score += lockPoints[lock.name];
    confirm(`Z√°mek ${lock.name} z≈Øst√°v√° otev≈ôen√Ω, poƒçet z√≠skan√Ωch diamant≈Ø: ${lockPoints[lock.name]}.`);
  } else {
    confirm(`Z√°mek ${lock.name} se uzamknul.`);
  }

  // Aktualizujeme sk√≥re na obrazovce
  document.getElementById('score').innerText = `Deska ${boardId} - poƒçet bod≈Ø: ${score}`;

  // Posun na dal≈°√≠ kolo
  currentRound++;
  if (currentRound <= locks.length) {
    rollDice();       // Zah√°jen√≠ nov√©ho kola s nov√Ωm hodem
    startRound();     // P≈ôiprav√≠ hrac√≠ desku na nov√© kolo
  } else {
    calculateFinalScore();
    document.getElementById('score').innerText = `Deska ${boardId} - poƒçet bod≈Ø: ${score}`;
	updateGameStats(boardId, score);
    confirm("Hra skonƒçila!");
   
  }
}



// Funkce pro ukonƒçen√≠ kola, pokud jsou pou≈æity v≈°echny kostky
function endRound() {
  // Zkontrolujeme, zda jsou v≈°echny relevantn√≠ bu≈àky pro tento z√°mek vyplnƒõny
  const lock = locks[currentRound - 1];
  const allCellsFilled = lock.coordinates.every(({ row, col }) => {
    const cell = document.getElementById(`cell-${row}-${col}`);
    return cell.classList.contains('clicked');
  });

  if (allCellsFilled) {
      
   // Oznaƒç√≠me v≈°echny bu≈àky tohoto z√°mku jako 'O' v hern√≠ desce
    lock.coordinates.forEach(({ row, col }) => {
      const cell = document.getElementById(`cell-${row}-${col}`);
      cell.classList.add('opened'); // P≈ôid√°me t≈ô√≠du 'opened' pro vizu√°ln√≠ oznaƒçen√≠
      cell.textContent = 'o'; // Zmƒõn√≠me obsah bu≈àky na 'o'
    });   
      
    score += lockPoints[lock.name];
    confirm (`Z√°mek ${lock.name} z≈Øst√°v√° otev≈ôen√Ω, poƒçet z√≠skan√Ωch diamant≈Ø: ${lockPoints[lock.name]}.`);
  } else {
    confirm (`Z√°mek ${lock.name} se uzamknul.`);
  }



  // Posun na dal≈°√≠ kolo a nov√Ω hod kostkami
  currentRound++;
  if (currentRound <= locks.length) {
  	document.getElementById('score').innerText = `Deska ${boardId} - poƒçet bod≈Ø: ${score}`;
    rollDice();
    startRound();
   
  } else {   
    calculateFinalScore();
   	document.getElementById('score').innerText = `Deska ${boardId} - poƒçet bod≈Ø: ${score}`;
	updateGameStats(boardId, score);
    confirm("Hra skonƒçila!");
  }
}




// Aktualizace tlaƒç√≠tek ReRoll
  function updateReRollButtons() {
    const isAnyDieSelected = selectedDice.some(selected => selected);
    const reRollButtons = document.querySelectorAll('.reroll-button');
    reRollButtons.forEach(button => {
      button.classList.toggle('disabled', !isAnyDieSelected);
    });
  }

  // Mo≈ænost opakovan√©ho hodu
function reRollDice(rerollIndex) {
  if (selectedDice.length > 0) {    
  const diceElements = document.querySelectorAll('.die:not(.used).clicked');
  diceElements.forEach((die, index) => {
    const newRoll = Math.floor(Math.random() * 6) + 1; // Nov√° hodnota od 1 do 6
    die.innerText = newRoll;
    die.classList.remove('clicked'); // Reset kliknut√≠ po hodu

    // Aktualizace pole dice pro tuto kostku
    const dieIndex = Array.from(document.querySelectorAll('.die')).indexOf(die);
    dice[dieIndex] = newRoll;
  });

  // Reset pole selectedDice, aby obsahovalo pouze nov√© hodnoty
  selectedDice = []; // T√≠m zajist√≠me, ≈æe se star√© hodnoty nep≈ôiƒç√≠taj√≠
  const button = document.getElementById(`reRoll${rerollIndex}`);
  button.classList.add('disabled');
  button.onclick = null; // Zamezen√≠ opƒõtovn√©mu kliknut√≠
  } else {
    confirm ("Vyberte alespo≈à jednu kostku pro opakovan√Ω hod.");
  }
}

function showSkimmerOptions(index) {
  const skimmerName = `≈†perh√°k ${index + 1}`;
  const option = prompt(`Vybrali jste ${skimmerName}\nVyberte mo≈ænost:\n(zadejte ƒç√≠slo volby)\n1) Ulo≈æit do nƒõj hodnoty kostek \n2) Pou≈æ√≠t ho jako dal≈°√≠ kostku`);
  if (option === "1") {
    addDiceToSkimmer(index);
  } else if (option === "2") {
    useSkimmerAsDie(index);
  } else {
    confirm ("Neplatn√° volba. Zkuste to znovu.");
  }
}


// P≈ôid√°n√≠ vybran√Ωch kostek do skimmeru
function addDiceToSkimmer(index) {
  if (document.querySelectorAll('.skimmer')[index].classList.contains('disabled')) {
    confirm ("Tento ≈†perh√°k ji≈æ nelze pou≈æ√≠t.");
    return;
  }  
  if (selectedDice.length > 0) {
    // Souƒçet hodnot vybran√Ωch kostek
    const diceSum = selectedDice.reduce((a, b) => a + b, 0);
    const remainingCapacity = 20 - skimmers[index];

    // Kontrola, zda vybran√© kostky nep≈ôesahuj√≠ zb√Ωvaj√≠c√≠ kapacitu skimmeru
    if (diceSum > remainingCapacity) {
      confirm (`Nelze p≈ôidat: hodnota kostek [${diceSum}] p≈ôekraƒçuje zb√Ωvaj√≠c√≠ kapacitu  [${remainingCapacity}] ≈°perh√°ku.`);
    } else {
      // P≈ôid√°n√≠ kostek do skimmeru a aktualizace UI
      skimmers[index] += diceSum;
      document.getElementById(`skimmer${index + 1}`).innerText = skimmers[index];

      // Oznaƒçen√≠ vybran√Ωch kostek jako pou≈æit√Ωch
      document.querySelectorAll('.die.clicked').forEach(die => {
        die.classList.add('used');
        die.classList.remove('clicked');
	document.querySelectorAll('.cell').forEach(cell => {
			cell.classList.remove('highlight'); // Odstran√≠me star√© zv√Ωraznƒõn√≠
		  });
      });

      selectedDice = []; // Reset vybran√Ωch kostek po p≈ôenosu
      highlightPossibleCells(); //
      // Zkontrolovat, zda byly pou≈æity v≈°echny kostky
      checkAllDiceUsed();
    }
  } else {
    confirm ("Vyberte alespo≈à jednu kostku pro p≈ôesun do ≈†perh√°ku.");
  }
}


function useSkimmerAsDie(index) {
  if (skimmers[index] > 0) {
    selectedDice.push(skimmers[index]);
    document.querySelectorAll('.skimmer')[index].classList.add('clicked');
    document.querySelectorAll('.skimmer')[index].onclick = null; // Zamezen√≠ opƒõtovn√©mu pou≈æit√≠ skimmeru
    confirm (`Vybrali jste ≈†perh√°k ${index + 1}\nByl pou≈æit jako kostka\ns hodnotou [${skimmers[index]}].\nVyber pole na hrac√≠ desce,\np≈ô√≠padnƒõ zkombinuj s jinou kostkou.`);
	document.querySelectorAll('.cell').forEach(cell => {
			cell.classList.remove('highlight'); // Odstran√≠me star√© zv√Ωraznƒõn√≠
			highlightPossibleCells(); //
	// Zv√Ωraznƒõn√≠ pol√≠ƒçek na hrac√≠ desce, kter√© odpov√≠daj√≠ nƒõkter√©mu z mo≈æn√Ωch souƒçt≈Ø nebo rozd√≠l≈Ø
		  document.querySelectorAll('.cell').forEach(cell => {
			const cellValue = cell.innerText;

	if (skimmers.includes(parseInt(cellValue)) // P≈ôid√°n√≠ podm√≠nky pro skimmery
			) {
		console.log(`Zv√Ωraznƒõno pole: (${cell.id}) s hodnotou ${cellValue}`);
			  cell.classList.add('highlight',); // Zv√Ωrazn√≠me pol√≠ƒçko, pokud odpov√≠d√° hodnotƒõ nebo kombinaci kostek
			}})
		  });

  } else {
    confirm ("Hodnota ≈†perh√°ku mus√≠ b√Ωt minim√°lnƒõ 1.");
  }
}



function highlightPossibleCells() {
  const currentLock = locks[currentRound - 1]; // Z√≠sk√°n√≠ aktu√°ln√≠ho z√°mku
  const lockCoordinates = new Set(
    currentLock.coordinates.map(({ row, col }) => `cell-${row}-${col}`)
  );

	


	// Vytvo≈ôen√≠ seznamu aktivn√≠ch kostek (vƒçetnƒõ virtu√°ln√≠ kostky, pokud existuje)
  const activeDice = virtualDice !== null ? [virtualDice] : selectedDice;
  console.log("Aktivn√≠ hodnoty pro zv√Ωraznƒõn√≠:", activeDice);
  

  // Generov√°n√≠ v≈°ech mo≈æn√Ωch souƒçt≈Ø a rozd√≠l≈Ø z vybran√Ωch kostek
  const possibleSumsAndDiffs = generatePossibleSumsAndDiffs(selectedDice);
	console.log("Mo≈æn√© souƒçty a rozd√≠ly:", Array.from(possibleSumsAndDiffs));

  document.querySelectorAll('.cell').forEach(cell => {
    const cellValue = cell.innerText.trim();
    const cellId = cell.id;

    // Podm√≠nky pro speci√°ln√≠ hodnoty
    const isOdd = activeDice.length === 1 && activeDice[0] % 2 !== 0;
    const isEven = activeDice.length === 1 && activeDice[0] % 2 === 0;
    const isDoubleSame =
      activeDice.length === 2 && activeDice[0] === activeDice[1];

    // Kontrola, zda bu≈àka spl≈àuje nƒõkterou z podm√≠nek pro oznaƒçen√≠ zelenou barvou
    if (
      (cellValue === 'L' && isOdd) ||
      (cellValue === 'S' && isEven) ||
      (cellValue === 'D' && isDoubleSame) ||
      possibleSumsAndDiffs.has(parseInt(cellValue))
    ) {
      cell.classList.add('highlight'); // Nastav√≠ zelenou barvu
	  console.log(`Zv√Ωraznƒõno pole: ${cellId} s hodnotou ${cellValue}`);
      cell.classList.remove('highlight-empty');
    } else if (lockCoordinates.has(cellId)) {
      // Pokud bu≈àka pat≈ô√≠ k aktu√°ln√≠mu z√°mku, obnov√≠me ≈ælutou barvu
      cell.classList.remove('highlight'); // Odstran√≠ zelenou barvu
      cell.classList.add('highlight-empty'); // Nastav√≠ zpƒõt na ≈ælutou
    } else {
      // Pro ostatn√≠ bu≈àky odstran√≠me jak√©koli zv√Ωraznƒõn√≠
      cell.classList.remove('highlight', 'highlight-empty');
    }
  });
}
	




// Pomocn√° funkce pro generov√°n√≠ v≈°ech mo≈æn√Ωch souƒçt≈Ø a rozd√≠l≈Ø z vybran√Ωch kostek
function generatePossibleSumsAndDiffs(diceArray) {
  const results = new Set();
  
  function calculateCombinations(dice, currentSum) {
    if (dice.length === 0) {
      results.add(currentSum); // P≈ôid√°me aktu√°ln√≠ souƒçet do v√Ωsledk≈Ø
      return;
    }

    for (let i = 0; i < dice.length; i++) {
      const remainingDice = dice.slice(0, i).concat(dice.slice(i + 1));
      calculateCombinations(remainingDice, currentSum + dice[i]);
      calculateCombinations(remainingDice, currentSum - dice[i]);
    }
  }

  calculateCombinations(diceArray, 0); // Spust√≠me v√Ωpoƒçet kombinac√≠ se souƒçtem 0
  return results;
}



// Vygenerov√°n√≠ v≈°ech mo≈æn√Ωch souƒçt≈Ø a rozd√≠l≈Ø z vybran√Ωch kostek
function generatePossibleSumsAndDiffs(diceArray) {
  const results = new Set();
  
  function calculateCombinations(dice, currentSum, currentDiff) {
    if (dice.length === 0) {
      results.add(currentSum);
      results.add(Math.abs(currentDiff));
      return;
    }

    for (let i = 0; i < dice.length; i++) {
      const remainingDice = dice.slice(0, i).concat(dice.slice(i + 1));
      calculateCombinations(remainingDice, currentSum + dice[i], currentDiff + dice[i]);
      calculateCombinations(remainingDice, currentSum - dice[i], currentDiff - dice[i]);
    }
  }

  calculateCombinations(diceArray, 0, 0);
console.log("Vygenerovan√© kombinace souƒçt≈Ø a rozd√≠l≈Ø:", results);
  return results;
}



  // P≈ôepnut√≠ stavu kostky (oznaƒçen√≠/odznaƒçen√≠) a p≈ôid√°n√≠/odebr√°n√≠ jej√≠ hodnoty do/z vybran√Ωch kostek
  function toggleDie(index) {
    const die = document.querySelectorAll('.die')[index];
    const dieValue = dice[index];

    	if (!die.classList.contains('used')) { // Kostku lze vybrat, pouze pokud nebyla pou≈æita
      die.classList.toggle('clicked');

      if (die.classList.contains('clicked')) {
        selectedDice.push(dieValue); // P≈ôidat hodnotu kostky do vybran√Ωch
      } else {
      selectedDice = selectedDice.filter((value, idx) => idx !== selectedDice.indexOf(dieValue));
      }
    console.log("Aktu√°ln√≠ vybran√© kostky:", selectedDice); // Pro kontrolu stavu
	  highlightPossibleCells(); // Aktualizace zv√Ωraznƒõn√≠ pol√≠ po zmƒõnƒõ v√Ωbƒõru kostek
    }
  }


// Funkce pro oznaƒçen√≠ pol√≠ƒçka na desce podle pravidel pro 'L', 'S' a 'D'
function markCell(row, col, cellValue) {
  const cell = document.getElementById(`cell-${row}-${col}`);
console.log(`--- markCell called ---`);
  console.log(`Vybran√© pol√≠ƒçko ≈ô√°dek: ${row}, sloupec: ${col}, hodnota: ${cellValue}`);
  
  // Podm√≠nky pro jednotliv√© kombinace kostek
  const isSingleOdd = selectedDice.length === 1 && selectedDice[0] % 2 !== 0;
  const isSingleEven = selectedDice.length === 1 && selectedDice[0] % 2 === 0;
  const isDoubleSame = selectedDice.length === 2 && selectedDice[0] === selectedDice[1];
  	
	

  // Funkce pro generov√°n√≠ v≈°ech mo≈æn√Ωch souƒçt≈Ø a rozd√≠l≈Ø z vybran√Ωch kostek
  function generatePossibleSumsAndDiffs(diceArray) {
    const results = new Set();
    
    // Rekurzivn√≠ funkce pro generov√°n√≠ v≈°ech kombinac√≠ sƒç√≠t√°n√≠ a odeƒç√≠t√°n√≠
    function calculateCombinations(dice, currentSum, currentDiff) {
      if (dice.length === 0) {
        results.add(currentSum); // P≈ôid√°me souƒçet
        results.add(Math.abs(currentDiff)); // P≈ôid√°me rozd√≠l
        return;
      }

      // Pro ka≈ædou kostku, rozhodneme, zda ji p≈ôiƒçteme nebo odeƒçteme
      for (let i = 0; i < dice.length; i++) {
        const remainingDice = dice.slice(0, i).concat(dice.slice(i + 1));

        // P≈ôedstavuje mo≈ænost p≈ôiƒç√≠st aktu√°ln√≠ kostku
        calculateCombinations(remainingDice, currentSum + dice[i], currentDiff + dice[i]);
        
        // P≈ôedstavuje mo≈ænost odeƒç√≠st aktu√°ln√≠ kostku
        calculateCombinations(remainingDice, currentSum - dice[i], currentDiff - dice[i]);
      }
    }

    // Zaƒçneme rekurzivn√≠ v√Ωpoƒçty pro v≈°echny kostky
    calculateCombinations(diceArray, 0, 0);

    return results;
  }

  // Vygeneruj v≈°echny mo≈æn√© souƒçty a rozd√≠ly
  const possibleSumsAndDiffs = generatePossibleSumsAndDiffs(selectedDice);

  // Zkontroluj, jestli hodnota bu≈àky odpov√≠d√° nƒõkter√©mu z mo≈æn√Ωch souƒçt≈Ø nebo rozd√≠l≈Ø
  if (
    (cellValue === 'L' && isSingleOdd) ||
    (cellValue === 'S' && isSingleEven) ||
    (cellValue === 'D' && isDoubleSame) ||
    possibleSumsAndDiffs.has(parseInt(cellValue)) // Zkontroluj, jestli je hodnota v seznamu mo≈æn√Ωch souƒçt≈Ø a rozd√≠l≈Ø
  ) {
    cell.classList.add('clicked'); // Oznaƒçen√≠ pol√≠ƒçka jako "kliknut√©"
	document.querySelectorAll('.cell').forEach(cell => {
		cell.classList.remove('highlight'); // Odstran√≠me star√© zv√Ωraznƒõn√≠
	  });
    // Oznaƒçen√≠ vybran√Ωch kostek jako pou≈æit√Ωch a odstranƒõn√≠ jejich v√Ωbƒõru
    document.querySelectorAll('.die.clicked').forEach(die => {
      die.classList.add('used');
      die.classList.remove('clicked');
    });
	// Oznaƒçen√≠ vybran√Ωch Skimmer≈Ø jako pou≈æit√Ωch a odstranƒõn√≠ jejich v√Ωbƒõru
	document.querySelectorAll('.skimmer.clicked').forEach(skimmer => {
      skimmer.classList.add('used');
      skimmer.classList.remove('clicked');
    });
    
    selectedDice = []; // Reset vybran√Ωch kostek po pou≈æit√≠

    // Zkontrolovat, zda byly pou≈æity v≈°echny kostky
    checkAllDiceUsed();
    highlightPossibleCells();
  } else {
    confirm ("Hodnota kostek neodpov√≠d√° po≈æadavk≈Øm na toto pole.");
  }
}

function startGame() {
  currentRound = 1;
  score = 0;
  rollDice();
  startRound();
  document.getElementById('score').innerText = `Deska ${boardId} - poƒçet bod≈Ø: ${score}`;
  
// Ovƒõ≈ôte, ≈æe boardId je nastaven√© p≈ôed naƒç√≠t√°n√≠m sk√≥re
  if (boardId) {
    const highScore = loadHighScore(boardId);
    document.getElementById('high-score').innerText = `Deska ${boardId} - nejvy≈°≈°√≠ dosa≈æen√© sk√≥re: ${highScore}`;
  } else {
    console.error("boardId nen√≠ definov√°no p≈ôi naƒç√≠t√°n√≠ sk√≥re");
  }
}



	function selectBoardMenu() {
	location.reload();
	}


	// Inicializace hry
	function initGame() {
	  selectBoard(); // umo≈æn√≠ v√Ωbƒõr desky
	  createBoard(); // vytvo≈ô√≠ vybranou desku
	  startGame();   // zah√°j√≠ hru s vybranou deskou
	}


initGame();



</script>
</body>
</html>
